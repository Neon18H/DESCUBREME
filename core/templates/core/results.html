{% extends 'base.html' %}
{% block content %}
<div class="container py-5">
  <div class="glass-card p-4 mb-4">
    <h2>{{ plan.title }}</h2>
    <p class="mb-0">{{ plan.city }} Â· mood {{ plan.mood }} Â· estimado COP {{ plan.ai_plan_json.total_estimated_cost_cop|default:0 }}</p>
  </div>
  <div class="timeline">
    {% for step in plan.steps.all %}
      <article class="timeline-item glass-card p-3 mb-3">
        <span class="badge bg-info">{{ step.block|title }}</span>
        <h5 class="mt-2">{{ step.place_name }}</h5>
        <p>{{ step.description }}</p>
        <small>â± {{ step.est_time_minutes }} min Â· ğŸ’¸ {{ step.est_cost_cop }} Â· â­ {{ step.rating|default:'N/A' }}</small>
        <div>{% if step.maps_url %}<a href="{{ step.maps_url }}" target="_blank">Abrir Maps</a>{% endif %}</div>
      </article>
    {% endfor %}
  </div>
  {% if user.is_authenticated %}
    {% if not plan.is_saved %}
    <form method="post" action="{% url 'save_plan' plan.id %}">{% csrf_token %}<button class="btn btn-success">Guardar plan</button></form>
    {% endif %}
  {% else %}
    <a class="btn btn-light" href="{% url 'login' %}?next={% url 'plan_results' plan.id %}">Inicia sesiÃ³n para guardar</a>
  {% endif %}
</div>
{% endblock %}
